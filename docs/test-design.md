# レッツゴーデベロッパーモバイル 料金計算システム テスト設計書

**作成日:** 2025-10-11
**バージョン:** 1.0

---

## 目次
1. [プラン選択テスト](#1-プラン選択テスト)
2. [通話料金計算テスト](#2-通話料金計算テスト)
3. [無料通話対象外番号テスト](#3-無料通話対象外番号テスト)
4. [SMS料金計算テスト](#4-sms料金計算テスト)
5. [データ通信量テスト](#5-データ通信量テスト)
6. [日割り計算テスト](#6-日割り計算テスト)
7. [割引適用ロジックテスト](#7-割引適用ロジックテスト)
8. [契約解除料テスト](#8-契約解除料テスト)
9. [オプションサービステスト](#9-オプションサービステスト)
10. [データ関連オプションテスト](#10-データ関連オプションテスト)
11. [データ快適モード回数設定テスト](#11-データ快適モード回数設定テスト)
12. [事務手数料テスト](#12-事務手数料テスト)
13. [初回請求合算テスト](#13-初回請求合算テスト)
14. [消費税計算テスト](#14-消費税計算テスト)
15. [E2Eシナリオテスト](#15-e2eシナリオテスト)
16. [異常系テスト](#16-異常系テスト)

---

## 1. プラン選択テスト

### テスト目的
基本プラン（3種類）とデータ定額プラン（7種類）の組み合わせが正しく選択・適用されることを確認する。

### テスト対象
- **基本プラン:** THE NEXT (4,500円)、変真 (3,500円)、X (2,500円)
- **データプラン:**
  - 定額型: LL (7,000円)、L (6,000円)、M (4,500円)
  - 段階型: S (2,900円〜7,000円、4段階)

### テスト技法
- ペアワイズ法（組み合わせ削減）
- 同値分割（各プランタイプから代表値）

### テストタイプ
機能テスト（Functional Testing）

### テスト戦略
全組み合わせ（3 × 7 = 21通り）は冗長なため、ペアワイズ法で9ケースに削減。
- 全ての基本プラン（3種類）を最低1回使用
- 全てのデータプラン（7種類）を最低1回使用
- 定額型と段階型の両方をカバー
- 最小・最大構成を含む

### 確認ポイント
1. プラン選択が正常に完了すること
2. 基本プラン料金が正しく適用されること
3. データプラン料金が正しく適用されること
4. インターネット接続料300円が加算されること
5. 合計金額が正しいこと（税抜）
6. 選択したプラン内容が画面/データに反映されること

### テストケース数
9ケース（詳細は testcases/01_plan-selection.md 参照）

---

## 2. 通話料金計算テスト

### テスト目的
各基本プランでの通話料金計算ロジックが正しく動作することを確認する。

### テスト対象
- **THE NEXT プラン:** 国内通話かけ放題 ※3
- **変真 プラン:** 5分以内無料 ※3 ※4 ※6
- **X プラン:** 30秒ごとに20円 ※5 ※6

### テスト技法
- 境界値分析（5分、30秒の境界）
- 同値分割（3プランの通話料金体系）
- デシジョンテーブル（通話時間 × プランタイプ）

### テストタイプ
機能テスト（Functional Testing）

### テスト戦略

#### THE NEXT プラン
- 通話時間に関わらず追加料金なし
- 無料通話対象外の番号は別途課金（テスト項目3で実施）

#### 変真 プラン
- 境界値: 4分59秒、5分00秒、5分01秒
- 5分超過分の課金確認（30秒ごとに20円）
- 月またぎ通話の請求月確認 ※6

#### X プラン
- 境界値: 29秒、30秒、31秒、59秒、60秒
- 30秒未満でも20円課金
- 月またぎ通話の請求月確認 ※6

### 確認ポイント
1. 各プランの通話料金が正しく計算されること
2. 境界値で正しく動作すること
3. 月またぎ通話が終了月の請求に含まれること ※6

### テストケース数
10〜12ケース

---

## 3. 無料通話対象外番号テスト

### テスト目的
THE NEXTプラン、変真プランでも課金される特定番号の動作を確認する。

### テスト対象
- 国際電話
- テレドーム（0180）
- ナビダイヤル（0570）
- 番号案内（104）

### テスト技法
- 同値分割（無料対象/対象外）

### テストタイプ
機能テスト（Functional Testing）

### 確認ポイント
1. 無料通話対象外の番号では、THE NEXT/変真プランでも課金されること
2. 通常番号では無料で通話できること

### テストケース数
5ケース

---

## 4. SMS料金計算テスト

### テスト目的
SMS送信時の文字数による課金計算が正しく動作することを確認する。

### テスト対象
- **THE NEXT/変真 プラン:** 送受信無料
- **X プラン:** 送信3円/1通 ※9、受信無料

### テスト技法
- 境界値分析（67文字、134文字の境界）
- 同値分割（無料プラン/有料プラン）

### テストタイプ
機能テスト（Functional Testing）

### テスト戦略（Xプラン）
※9: 134文字までは2通分、それ以降は67文字ごとに1通分

- 67文字境界: 66文字（1通=3円）、67文字（1通=3円）、68文字（2通=6円）
- 134文字境界: 133文字（2通=6円）、134文字（2通=6円）、135文字（3通=9円）
- 201文字境界: 200文字（3通=9円）、201文字（3通=9円）、202文字（4通=12円）

### 確認ポイント
1. 文字数に応じた通数計算が正しいこと
2. 各プランで送信料金が正しく計算されること
3. 受信は全プラン無料であること

### テストケース数
8ケース

---

## 5. データ通信量テスト

### テスト目的
データ使用量による料金変動と速度制限が正しく動作することを確認する。

### テスト対象
- 仮面データパックS（段階型）の段階変化
- 定額プランの容量超過時の低速化 ※7

### テスト技法
- 境界値分析（各容量の上限値前後）
- 同値分割（定額プラン/段階型プラン）
- 状態遷移テスト（使用量増加による段階変化）

### テストタイプ
機能テスト（Functional Testing）

### テスト戦略

#### 仮面データパックS（段階型）の境界値
- 1GB境界: 0.99GB（2,900円）、1.00GB（2,900円）、1.01GB（4,000円）
- 3GB境界: 2.99GB（4,000円）、3.00GB（4,000円）、3.01GB（5,000円）
- 5GB境界: 4.99GB（5,000円）、5.00GB（5,000円）、5.01GB（7,000円）
- 20GB境界: 19.99GB（7,000円）、20.00GB（7,000円）、20.01GB（7,000円+低速化）

#### 定額プランの容量超過 ※7
- 50GB超過 → 128kbps低速化

### 確認ポイント
1. 段階型プランで使用量に応じた料金変化が正しいこと
2. 容量超過時に128kbpsに低速化すること
3. 境界値で正しく動作すること

### テストケース数
12ケース

---

## 6. 日割り計算テスト

### テスト目的
月途中契約・解約時の料金計算が正しく動作することを確認する。

### テスト対象
- 基本プラン ※1
- データ定額プラン ※8
- インターネット接続料 ※2
- オプションサービス ※15（日割りなし、満額請求）

### テスト技法
- 境界値分析（月初、月末）
- 同値分割（日割り対象/対象外）

### テストタイプ
機能テスト（Functional Testing）

### テスト戦略

#### 日割り対象（※1, ※2, ※8）
- 月初（1日）契約 → 満額請求
- 月中（15日）契約 → 日割り計算
- 月末（28/29/30/31日）契約 → 日割り計算
- 月途中解約 → 日割り計算
- 月途中プラン変更 → 日割り計算
- 四捨五入: 1円未満の端数は四捨五入

#### 日割り非対象（※15）
- オプションサービスは月途中でも満額請求

### 確認ポイント
1. 日割り計算が正しく行われること
2. 1円未満の四捨五入が正しいこと
3. オプションは日割りされず満額請求されること

### テストケース数
15ケース

---

## 7. 割引適用ロジックテスト

### テスト目的
長期契約割引、MNP割引の適用・終了タイミングが正しいことを確認する。

### テスト対象
- **長期契約割引:** 2年契約（500円/月）、3年契約（1,000円/月）、24ヶ月間 ※10 ※11
- **MNP割引:** 500円/月、12ヶ月間 ※12

### テスト技法
- 状態遷移テスト（契約月数による割引の開始・終了）
- デシジョンテーブル（割引種類 × 契約期間 × 解除有無）
- 境界値分析（割引開始月、終了月）

### テストタイプ
機能テスト（Functional Testing）

### テスト戦略

#### 長期契約割引（※10, ※11）
- 割引開始: 加入月の翌月（1ヶ月目）
- 割引終了: 24ヶ月目
- 境界値: 23ヶ月目、24ヶ月目、25ヶ月目
- 解除月: 割引適用なし ※11

#### MNP割引（※12）
- 割引開始: 加入月の翌月（1ヶ月目）
- 割引終了: 12ヶ月目
- 境界値: 11ヶ月目、12ヶ月目、13ヶ月目
- 解除月: 割引適用なし ※12

#### 複数割引併用
- 長期契約（2年/3年） + MNP の組み合わせ

### 確認ポイント
1. 割引が正しい月から開始されること
2. 割引が正しい月で終了すること
3. 解除月は割引適用されないこと
4. 複数割引が正しく併用されること

### テストケース数
15ケース

---

## 8. 契約解除料テスト

### テスト目的
最低契約期間内での契約解除時に解除料が正しく課金されることを確認する。

### テスト対象
- 契約解除料: 9,500円 ※10

### テスト技法
- 境界値分析（最低契約期間の境界）
- デシジョンテーブル（契約タイプ × 解除月）

### テストタイプ
機能テスト（Functional Testing）

### テスト戦略

#### 通常契約（最低契約期間1年）
- 11ヶ月目での解除 → 解除料9,500円
- 12ヶ月目での解除 → 解除料9,500円
- 13ヶ月目での解除 → 解除料なし（境界値）

#### 2年契約
- 23ヶ月目での解除 → 解除料9,500円
- 24ヶ月目での解除 → 解除料9,500円
- 25ヶ月目での解除 → 解除料なし（境界値）

#### 3年契約
- 35ヶ月目での解除 → 解除料9,500円
- 36ヶ月目での解除 → 解除料9,500円
- 37ヶ月目での解除 → 解除料なし（境界値）

### 確認ポイント
1. 最低契約期間内の解除で9,500円が課金されること
2. 最低契約期間経過後は解除料がかからないこと
3. 境界月で正しく動作すること

### テストケース数
9ケース

---

## 9. オプションサービステスト

### テスト目的
オプション加入・解約・無料期間が正しく動作することを確認する。

### テスト対象
- あんしん補償サービス: 330円/月 ※14 ※15
- あんしん遠隔サポート: 400円/月 ※14 ※15
- あんしんネットセキュリティ: 500円/月 ※14 ※15
- あんしんパック: 1,000円/月 ※14 ※15

### テスト技法
- 状態遷移テスト（加入月 → 無料期間 → 有料期間 → 解約）
- 同値分割（個別オプション/パックオプション）
- デシジョンテーブル（オプション組み合わせ）

### テストタイプ
機能テスト（Functional Testing）

### テスト戦略

#### 初回2ヶ月無料（※14）
- 加入月: 無料
- 翌月: 無料
- 3ヶ月目: 有料開始

#### あんしんパック vs 個別加入
- パック: 1,000円
- 個別合計: 330 + 400 + 500 = 1,230円
- 差額: 230円お得

#### 月途中加入・解約（※15）
- 満額請求の確認

### 確認ポイント
1. 初回2ヶ月無料が正しく適用されること
2. 3ヶ月目から課金されること
3. パック料金が正しく適用されること
4. 月途中でも満額請求されること

### テストケース数
12ケース

---

## 10. データ関連オプションテスト

### テスト目的
データ繰り越し、増量、快適モードが正しく動作することを確認する。

### テスト対象
- データ繰り越し ※16
- データ増量 ※16 ※17
- データ快適モード ※16 ※17

### テスト技法
- 境界値分析（1GB未満の繰り越し不可、90日有効期限）
- 状態遷移テスト（容量消費の優先順位）
- 同値分割（繰り越し/増量/快適モード）

### テストタイプ
機能テスト（Functional Testing）

### テスト戦略

#### データ繰り越し（※16）
- 1GB未満は繰り越されない（境界値: 0.99GB、1.00GB）
- 翌月までで消失

#### データ増量/快適モード（※16, ※17）
- 料金: 1,000円/1GB
- 有効期間: 購入日含め90日間
- 境界値: 89日目、90日目、91日目

#### 消費優先順位（※16）
- ①繰り越し → ②定額プラン → ③快適モード → ④増量
- 複数容量混在時の消費順序

### 確認ポイント
1. 1GB以上の容量が繰り越されること
2. 1GB未満は繰り越されないこと
3. 増量容量が90日で消失すること
4. 消費優先順位が正しいこと

### テストケース数
10ケース

---

## 11. データ快適モード回数設定テスト

### テスト目的
自動増量回数の1〜10回、無制限設定が正しく動作することを確認する。

### テスト対象
- データ快適モードの自動増量回数設定

### テスト技法
- 境界値分析（設定回数の境界）
- 同値分割（回数制限あり/無制限）

### テストタイプ
機能テスト（Functional Testing）

### テスト戦略
- 設定1回: 1回増量後は低速化
- 設定5回: 5回増量後は低速化
- 設定10回: 10回増量後は低速化
- 無制限設定: 何回でも増量可能
- 境界値: 設定回数ちょうどでの動作確認

### 確認ポイント
1. 設定回数まで増量されること
2. 設定回数超過後は低速化すること
3. 無制限設定で制限なく増量されること

### テストケース数
5ケース

---

## 12. 事務手数料テスト

### テスト目的
初回請求時の事務手数料加算が正しいことを確認する。

### テスト対象
- 新規契約: 3,000円
- MNP: 3,000円
- 機種変更: 3,000円

### テスト技法
- 同値分割（新規/MNP/機種変更）

### テストタイプ
機能テスト（Functional Testing）

### 確認ポイント
1. 初回請求に事務手数料が加算されること
2. 2ヶ月目以降は事務手数料がないこと

### テストケース数
4ケース

---

## 13. 初回請求合算テスト

### テスト目的
事務手数料が初回請求に正しく合算されることを確認する。

### テスト対象
- 初回請求 = 基本料金 + データ料金 + オプション + 事務手数料

### テスト技法
- ユースケーステスト

### テストタイプ
機能テスト（Functional Testing）

### 確認ポイント
1. 1ヶ月目: 全料金 + 事務手数料3,000円
2. 2ヶ月目: 全料金のみ（事務手数料なし）

### テストケース数
3ケース

---

## 14. 消費税計算テスト

### テスト目的
税込金額の計算と四捨五入が正しいことを確認する。

### テスト対象
- 計算式: (支払料金合算 - 割引額合算) × 消費税
- 1円未満の四捨五入

### テスト技法
- 境界値分析（四捨五入の境界）

### テストタイプ
機能テスト（Functional Testing）

### テスト戦略
- 四捨五入境界:
  - 税額0.4円 → 0円（切り捨て）
  - 税額0.5円 → 1円（切り上げ）
  - 税額0.6円 → 1円（切り上げ）

### 確認ポイント
1. 消費税が正しく計算されること
2. 1円未満の四捨五入が正しいこと

### テストケース数
5ケース

---

## 15. E2Eシナリオテスト

### テスト目的
実際の利用シナリオでの総合動作確認。

### テスト対象
- 新規契約からの一連のフロー

### テスト技法
- ユースケーステスト
- シナリオテスト

### テストタイプ
システムテスト（System Testing）、E2Eテスト

### テスト戦略

#### 最小構成
- Xプラン + 仮面データパックS(〜1GB) + 割引なし + オプションなし

#### 最大構成
- THE NEXTプラン + 仮面データパックLL(50GB) + 全オプション + 全割引

#### 現実的シナリオ
- 新規MNP契約（事務手数料 + MNP割引 + オプション2ヶ月無料）
- 長期利用（25ヶ月目で長期契約割引終了）
- プラン変更（月途中で日割り発生）

### テストケース数
8〜10ケース

---

## 16. 異常系テスト

### テスト目的
不正入力や異常データの処理を確認する。

### テスト対象
- エラーハンドリング

### テスト技法
- エラー推測（Error Guessing）
- 境界値分析（有効範囲外の値）

### テストタイプ
ネガティブテスト（Negative Testing）

### テスト戦略
- プラン未選択
- 負の値（通話時間-10分、データ量-5GB）
- 異常な大きさ（通話時間999999分）
- 無効な日付（2月30日、13月1日）
- NULL値、空文字

### テストケース数
8ケース
